<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Pagination</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .items-container {
            margin-bottom: 20px;
        }
        .pagination {
            display: flex;
            justify-content: center;
        }
        .pagination button {
            margin: 0 5px;
            padding: 5px 10px;
            cursor: pointer;
        }
        .pagination button:disabled {
            cursor: not-allowed;
            background-color: #ddd;
        }
    </style>
</head>
<body>

    <h1>API Pagination Example</h1>
    
    <!-- Container for the items -->
    <div id="items-container" class="items-container"></div>
    
    <!-- Pagination controls -->
    <div class="pagination">
        <button id="prev-btn" onclick="changePage('prev')">Previous</button>
        <span id="page-info">Page 1</span>
        <button id="next-btn" onclick="changePage('next')">Next</button>
    </div>

    <script>
        // API URL - replace with your actual API endpoint
        const apiUrl = "http://127.0.0.1:8000/get-post"; // Sample API for demonstration
        const itemsPerPage = 5; // Number of items per page
        let currentPage = 1; // Track the current page

        // Function to fetch data from the API with pagination parameters
        async function fetchData(page = 1, pageSize = itemsPerPage) {
            try {
                const response = await fetch(`${apiUrl}?_page=${page}&_limit=${pageSize}`);
                const data = await response.json();
                const totalItems = response.headers.get('X-Total-Count'); // Get the total item count from headers

                return {
                    items: data,
                    total: parseInt(totalItems, 10) // Convert the total count to an integer
                };
            } catch (error) {
                console.error('Error fetching data:', error);
                return { items: [], total: 0 };
            }
        }

        // Function to display items on the page
        async function displayItems() {
            const { items, total } = await fetchData(currentPage);
            const itemsContainer = document.getElementById('items-container');
            
            // Display the items
            itemsContainer.innerHTML = items.map(item => `<p>${item.title}</p>`).join('');

            // Calculate total pages
            const totalPages = Math.ceil(total / itemsPerPage);
            document.getElementById('page-info').textContent = `Page ${currentPage} of ${totalPages}`;

            // Disable previous/next buttons based on current page
            document.getElementById('prev-btn').disabled = currentPage === 1;
            document.getElementById('next-btn').disabled = currentPage === totalPages;
        }

        // Function to handle page changes
        function changePage(direction) {
            if (direction === 'next' && currentPage * itemsPerPage < 500) {
                currentPage++;
            } else if (direction === 'prev' && currentPage > 1) {
                currentPage--;
            }
            displayItems(); // Refresh the displayed items
        }

        // Initial display when the page loads
        displayItems();

    </script>

</body>
</html>
